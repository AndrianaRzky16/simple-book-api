{"version":3,"sources":["index.js"],"names":["app","port","use","express","json","timeLogger","requestLogger","requestModifier","set","get","req","res","render","name","books","console","log","setHeader","end","JSON","stringify","id","parseInt","params","book","find","b","error","query","title","toLowerCase","searchedBooks","filter","includes","post","newBook","body","push","writeHead","success","message","data","put","bookIndex","findIndex","Object","assign","splice","listen"],"mappings":"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","sourcesContent":["import express from \"express\";\r\nimport books from \"./books.js\";\r\nimport {\r\n  timeLogger,\r\n  requestLogger,\r\n  requestModifier,\r\n  checkToken,\r\n} from \"./middleware.js\";\r\n\r\nconst app = express();\r\nconst port = 3000;\r\n\r\napp.use(express.json());\r\n\r\napp.use(timeLogger);\r\napp.use(requestLogger);\r\napp.use(requestModifier);\r\n// app.use(checkToken);\r\n\r\napp.set(\"view engine\", \"ejs\");\r\napp.set(\"views\", \"./views\");\r\n\r\n//routes / URL / utama kita method GET\r\n\r\napp.get(\"/profile\", (req, res) => {\r\n  res.render(\"profile\", { name: \"John Doe\" });\r\n});\r\n\r\napp.get(\"/web/books\", (req, res) => {\r\n  res.render(\"books\", { books });\r\n});\r\n\r\napp.get(\"/books\", (req, res) => {\r\n  console.log();\r\n  res.setHeader(\"Content-Type\", \"application/json\");\r\n  res.end(JSON.stringify(books));\r\n});\r\n\r\napp.get(\"/books/:id\", (req, res) => {\r\n  const id = parseInt(req.params.id);\r\n  const book = books.find((b) => b.id === id);\r\n\r\n  if (book) {\r\n    res.setHeader(\"Content-Type\", \"application/json\");\r\n    res.end(JSON.stringify(book));\r\n  } else {\r\n    res.setHeader(\"Content-Type\", \"application/json\");\r\n    res.end(JSON.stringify({ error: \"Book not found\" }));\r\n  }\r\n});\r\n\r\napp.get(\"/search\", (req, res) => {\r\n  if (req.query.title) {\r\n    const title = req.query.title.toLowerCase();\r\n    const searchedBooks = books.filter((b) =>\r\n      b.title.toLowerCase().includes(title)\r\n    );\r\n    res.setHeader(\"Content-Type\", \"application/json\");\r\n    res.end(JSON.stringify(searchedBooks));\r\n  } else {\r\n    res.setHeader(\"Content-Type\", \"application/json\");\r\n    res.end(JSON.stringify({ error: \"No search criteria provided\" }));\r\n  }\r\n});\r\n\r\n//POST\r\n\r\napp.post(\"/books\", (req, res) => {\r\n  const newBook = req.body;\r\n  books.push(newBook);\r\n  res.setHeader(\"Content-Type\", \"application/json\");\r\n\r\n  if (newBook) {\r\n    res.writeHead(201);\r\n    res.end(\r\n      JSON.stringify({\r\n        success: true,\r\n        message: \"Book added successfully\",\r\n        data: books,\r\n      })\r\n    );\r\n  } else {\r\n    res.writeHead(500);\r\n    res.end(JSON.stringify({ error: \"Failed to add book\" }));\r\n  }\r\n});\r\n\r\n//PUT\r\n\r\napp.put(\"/books/:id\", (req, res) => {\r\n  const id = parseInt(req.params.id);\r\n  const bookIndex = books.findIndex((b) => b.id === id);\r\n\r\n  if (bookIndex !== -1) {\r\n    Object.assign(books[bookIndex], req.body);\r\n    res.setHeader(\"Content-Type\", \"application/json\");\r\n    res.writeHead(200);\r\n    res.end(\r\n      JSON.stringify({\r\n        success: true,\r\n        message: \"Book updated successfully\",\r\n        data: books[bookIndex],\r\n      })\r\n    );\r\n  } else {\r\n    res.setHeader(\"Content-Type\", \"application/json\");\r\n    res.writeHead(404);\r\n    res.end(JSON.stringify({ error: \"Book not found\" }));\r\n  }\r\n});\r\n\r\n//Delete\r\n\r\napp.delete(\"/books/:id\", (req, res) => {\r\n  const id = parseInt(req.params.id);\r\n  const bookIndex = books.findIndex((b) => b.id === id);\r\n\r\n  if (bookIndex !== -1) {\r\n    books.splice(bookIndex, 1);\r\n    res.setHeader(\"Content-Type\", \"application/json\");\r\n    res.writeHead(200);\r\n    res.end(\r\n      JSON.stringify({\r\n        success: true,\r\n        message: \"Book deleted successfully\",\r\n        data: books,\r\n      })\r\n    );\r\n  } else {\r\n    res.setHeader(\"Content-Type\", \"application/json\");\r\n    res.writeHead(404);\r\n    res.end(JSON.stringify({ error: \"Book not found\" }));\r\n  }\r\n});\r\n\r\napp.delete( )\r\n\r\napp.use((req, res) => {\r\n  res.setHeader(\"Content-Type\", \"application/json\");\r\n  res.writeHead(405);\r\n  res.end(JSON.stringify({ error: \"Method Not Allowed\" }));\r\n});\r\n\r\napp.listen(port, () => {\r\n  console.log(`Server running at http://localhost:${port}/`);\r\n});\r\n"],"file":"index.dev.js"}